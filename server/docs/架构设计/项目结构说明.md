# 团队报名系统服务端项目结构

本文档提供团队报名系统服务端的详细目录结构说明。更全面的架构设计和实现指南请参阅 [DDD架构设计指南](DDD架构设计指南.md)。

## 目录结构

```
/src
  /app.js                # 应用入口点
  /config/               # 配置文件
  /domains/              # 领域层
    /services/           # 通用领域服务
      BaseService.js     # 基础服务类
    /account/            # 账户领域
    /registration/       # 报名领域
    /payment/            # 支付领域
    /statistics/         # 统计领域
  /infrastructure/       # 基础设施层
    /common/             # 通用组件
      /di/               # 依赖注入
      /logging/          # 日志
      /cache/            # 缓存
      /utils/            # 工具类
    /data/               # 数据访问
    /external/           # 外部服务
    /web/                # Web组件
    /security/           # 安全组件
/docs                    # 文档目录
/tests                   # 测试目录
```

## 领域层详细结构

每个领域内部的目录结构：

```
/domains/{domain}            # 特定领域目录
  /models/                   # 领域模型
  /services/                 # 领域服务
  /controllers/              # 控制器
  /subdomains/               # 子领域目录
    /{subdomain}/            # 特定子领域
      /models/               # 子领域模型
      /services/             # 子领域服务
      /controllers/          # 子领域控制器
```

### 示例：报名领域结构

```
/domains/registration/
  /models/
    Registration.js          # 报名实体模型
  /services/
    RegistrationService.js   # 报名核心服务
  /controllers/
    registrationController.js # 报名控制器
  /subdomains/
    /team/                   # 团队报名子领域
      /services/
        TeamService.js       # 团队报名服务
      /controllers/
        teamController.js    # 团队报名控制器
    /individual/             # 个人报名子领域
      /services/
        IndividualService.js # 个人报名服务
      /controllers/
        individualController.js # 个人报名控制器
```

## 基础设施层详细结构

```
/infrastructure/
  /common/
    /di/
      Container.js           # 依赖注入容器
    /logging/
      LoggerService.js       # 日志服务
    /utils/
      IDGenerator.js         # ID生成器
  /data/
    /connectors/
      DatabaseConnector.js   # 数据库连接器
      ModelFactory.js        # 模型工厂
    /repositories/
      BaseRepository.js      # 基础仓储
  /external/
    /messaging/
      /email/
        EmailService.js      # 邮件服务
    /payment/
      /wechat/               # 微信支付SDK
      /alipay/               # 支付宝SDK
  /web/
    /middlewares/
      /auth/
        AuthMiddleware.js    # 认证中间件
      /handling/
        ErrorHandler.js      # 错误处理
    /response/
      ResponseFormatter.js   # 响应格式化
    /routes/
      RouteLoader.js         # 路由加载器
```

## 关键文件说明

### 应用启动相关

- **src/app.js**: 应用程序主入口点，负责初始化Express应用、加载中间件、依赖注入容器和事件发射器。

### 领域层关键文件

- **src/domains/services/BaseService.js**: 基础服务类，所有领域服务继承自它，提供通用功能和依赖解析。
- **src/domains/*/services/*.js**: 领域服务实现，包含核心业务逻辑。
- **src/domains/*/controllers/*.js**: API控制器，处理HTTP请求，调用领域服务。
- **src/domains/*/models/*.js**: 领域模型定义，包含字段定义和业务规则验证。

### 基础设施层关键文件

- **src/infrastructure/index.js**: 基础设施层入口，注册所有基础组件到容器。
- **src/infrastructure/common/di/Container.js**: 依赖注入容器，管理组件依赖关系。
- **src/infrastructure/data/connectors/DatabaseConnector.js**: 数据库连接管理。
- **src/infrastructure/web/routes/RouteLoader.js**: 加载所有领域路由到Express应用。

## 命名约定

- **文件夹命名**: 使用小写字母，多个单词之间不使用分隔符
- **文件命名**:
  - 模型: 大驼峰命名，如 `Registration.js`
  - 服务: 大驼峰命名 + Service后缀，如 `RegistrationService.js`
  - 控制器: 小驼峰命名 + Controller后缀，如 `registrationController.js`
  - 路由: 使用 `routes.js`
- **类命名**: 大驼峰命名，如 `RegistrationService`
- **方法命名**: 小驼峰命名，动词开头，如 `createRegistration`
- **变量命名**: 小驼峰命名，如 `userProfile`

## 文件引用规则

为保持代码清晰和领域边界明确，项目采用以下引用规则：

1. **同领域内引用**：使用相对路径
   ```javascript
   // 子领域服务引用主领域服务
   const registrationService = require('../../../services/RegistrationService');
   ```

2. **跨领域引用**：使用别名路径
   ```javascript
   // 跨领域引用
   const authService = require('@domains/account/subdomains/auth/services/AuthService');
   ```

3. **基础设施引用**：使用别名路径
   ```javascript
   // 基础设施组件引用
   const container = require('@common/di/Container');
   ```

更多关于架构设计和实现的内容，请参阅 [DDD架构设计指南](DDD架构设计指南.md)。
